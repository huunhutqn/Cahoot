{
  "version": 3,
  "sources": ["../src/common/validators/auth.ts", "../src/common/validators/quizz.ts", "../src/services/quizz.ts", "../src/routes/quizz.ts", "../src/env.ts", "../src/services/config.ts", "../src/common/types/game/status.ts", "../src/services/registry.ts", "../src/utils/game.ts", "../src/utils/sleep.ts", "../src/services/game.ts", "../src/index.ts"],
  "sourcesContent": ["import z from \"zod\";\r\n\r\nexport const usernameValidator = z\r\n  .string()\r\n  .min(4, \"Username cannot be less than 4 characters\")\r\n  .max(20, \"Username cannot exceed 20 characters\");\r\n\r\nexport const inviteCodeValidator = z.string().length(6, \"Invalid invite code\");\r\n", "import { z } from \"zod/v4\";\r\n\r\nexport const quizzQuestionValidator = z.object({\r\n  question: z.string().min(1, \"Question is required\"),\r\n  answers: z\r\n    .array(z.string())\r\n    .min(2, \"At least 2 answers required\")\r\n    .max(4, \"Maximum 4 answers allowed\"),\r\n  image: z.string().url().optional(),\r\n  solution: z.number().int().min(0, \"Solution index must be 0 or greater\"),\r\n  cooldown: z.number().int().min(0, \"Cooldown must be 0 or greater\"),\r\n  time: z.number().int().min(1, \"Time must be at least 1 second\"),\r\n});\r\n\r\nexport const quizzValidator = z.object({\r\n  subject: z.string().min(1, \"Subject is required\"),\r\n  questions: z\r\n    .array(quizzQuestionValidator)\r\n    .min(1, \"At least 1 question required\"),\r\n});\r\n\r\nexport const quizzIdValidator = z.string().regex(/^[a-zA-Z0-9_-]+$/, {\r\n  message: \"Quiz ID can only contain letters, numbers, hyphens and underscores\",\r\n});\r\n\r\nexport const createQuizzValidator = z.object({\r\n  id: quizzIdValidator,\r\n  data: quizzValidator,\r\n});\r\n\r\nexport const updateQuizzValidator = z.object({\r\n  id: quizzIdValidator,\r\n  data: quizzValidator,\r\n});\r\n\r\nexport const deleteQuizzValidator = z.object({\r\n  id: quizzIdValidator,\r\n});\r\n", "import { Quizz, QuizzWithId } from \"@/common/types/game\";\r\nimport fsSync from \"fs\";\r\nimport fs from \"fs/promises\";\r\nimport { resolve } from \"path\";\r\n\r\nconst inContainerPath = process.env.CONFIG_PATH;\r\n\r\nconst getPath = (path: string = \"\") =>\r\n  inContainerPath\r\n    ? resolve(inContainerPath, path)\r\n    : resolve(process.cwd(), \"config\", path);\r\n\r\nclass QuizzService {\r\n  // In-memory cache for quiz data\r\n  private static cache: Map<string, QuizzWithId> = new Map();\r\n  private static cacheTimestamp: number = 0;\r\n  private static readonly CACHE_TTL = 60000; // 60 seconds\r\n\r\n  /**\r\n   * Get all quizzes (with caching)\r\n   */\r\n  static async getAll(): Promise<QuizzWithId[]> {\r\n    // Check if cache is still valid\r\n    const now = Date.now();\r\n    if (this.cache.size > 0 && now - this.cacheTimestamp < this.CACHE_TTL) {\r\n      return Array.from(this.cache.values());\r\n    }\r\n\r\n    const quizzPath = getPath(\"quizz\");\r\n\r\n    // Check if directory exists (sync check is OK for directory)\r\n    if (!fsSync.existsSync(quizzPath)) {\r\n      return [];\r\n    }\r\n\r\n    try {\r\n      const files = await fs.readdir(quizzPath);\r\n      const jsonFiles = files.filter((file) => file.endsWith(\".json\"));\r\n\r\n      const quizzes = await Promise.all(\r\n        jsonFiles.map(async (file) => {\r\n          const data = await fs.readFile(getPath(`quizz/${file}`), \"utf-8\");\r\n          const config = JSON.parse(data);\r\n          const id = file.replace(\".json\", \"\");\r\n\r\n          return {\r\n            id,\r\n            ...config,\r\n          } as QuizzWithId;\r\n        }),\r\n      );\r\n\r\n      // Update cache\r\n      this.cache.clear();\r\n      quizzes.forEach((quiz) => this.cache.set(quiz.id, quiz));\r\n      this.cacheTimestamp = now;\r\n\r\n      return quizzes;\r\n    } catch (error) {\r\n      console.error(\"Failed to read quizz config:\", error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get all quizzes synchronously (for backward compatibility)\r\n   */\r\n  static getAllSync(): QuizzWithId[] {\r\n    const quizzPath = getPath(\"quizz\");\r\n\r\n    if (!fsSync.existsSync(quizzPath)) {\r\n      return [];\r\n    }\r\n\r\n    try {\r\n      const files = fsSync\r\n        .readdirSync(quizzPath)\r\n        .filter((file) => file.endsWith(\".json\"));\r\n\r\n      const quizz: QuizzWithId[] = files.map((file) => {\r\n        const data = fsSync.readFileSync(getPath(`quizz/${file}`), \"utf-8\");\r\n        const config = JSON.parse(data);\r\n        const id = file.replace(\".json\", \"\");\r\n\r\n        return {\r\n          id,\r\n          ...config,\r\n        };\r\n      });\r\n\r\n      return quizz || [];\r\n    } catch (error) {\r\n      console.error(\"Failed to read quizz config:\", error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get a single quiz by ID (async)\r\n   */\r\n  static async getById(id: string): Promise<QuizzWithId | null> {\r\n    // Check cache first\r\n    if (this.cache.has(id)) {\r\n      const cached = this.cache.get(id);\r\n      if (cached && Date.now() - this.cacheTimestamp < this.CACHE_TTL) {\r\n        return cached;\r\n      }\r\n    }\r\n\r\n    const filePath = getPath(`quizz/${id}.json`);\r\n\r\n    try {\r\n      const data = await fs.readFile(filePath, \"utf-8\");\r\n      const config = JSON.parse(data);\r\n      const quiz: QuizzWithId = { id, ...config };\r\n\r\n      // Update cache\r\n      this.cache.set(id, quiz);\r\n\r\n      return quiz;\r\n    } catch (error) {\r\n      if ((error as NodeJS.ErrnoException).code !== \"ENOENT\") {\r\n        console.error(`Failed to read quizz ${id}:`, error);\r\n      }\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get a single quiz by ID (sync - for backward compatibility)\r\n   */\r\n  static getByIdSync(id: string): QuizzWithId | null {\r\n    const filePath = getPath(`quizz/${id}.json`);\r\n\r\n    if (!fsSync.existsSync(filePath)) {\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      const data = fsSync.readFileSync(filePath, \"utf-8\");\r\n      const config = JSON.parse(data);\r\n\r\n      return {\r\n        id,\r\n        ...config,\r\n      };\r\n    } catch (error) {\r\n      console.error(`Failed to read quizz ${id}:`, error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create a new quiz (async)\r\n   */\r\n  static async create(\r\n    id: string,\r\n    data: Quizz,\r\n  ): Promise<{ success: boolean; error?: string }> {\r\n    const filePath = getPath(`quizz/${id}.json`);\r\n\r\n    // Check if quiz already exists\r\n    try {\r\n      await fs.access(filePath);\r\n      return { success: false, error: \"Quiz already exists\" };\r\n    } catch {\r\n      // File doesn't exist, continue\r\n    }\r\n\r\n    // Ensure quizz directory exists\r\n    const quizzDir = getPath(\"quizz\");\r\n    try {\r\n      await fs.mkdir(quizzDir, { recursive: true });\r\n    } catch (error) {\r\n      // Directory might already exist\r\n    }\r\n\r\n    try {\r\n      await fs.writeFile(filePath, JSON.stringify(data, null, 2), \"utf-8\");\r\n\r\n      // Invalidate cache\r\n      this.invalidateCache();\r\n\r\n      return { success: true };\r\n    } catch (error) {\r\n      console.error(`Failed to create quizz ${id}:`, error);\r\n      return { success: false, error: \"Failed to write file\" };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update an existing quiz (async)\r\n   */\r\n  static async update(\r\n    id: string,\r\n    data: Quizz,\r\n  ): Promise<{ success: boolean; error?: string }> {\r\n    const filePath = getPath(`quizz/${id}.json`);\r\n\r\n    // Check if quiz exists\r\n    try {\r\n      await fs.access(filePath);\r\n    } catch {\r\n      return { success: false, error: \"Quiz not found\" };\r\n    }\r\n\r\n    try {\r\n      await fs.writeFile(filePath, JSON.stringify(data, null, 2), \"utf-8\");\r\n\r\n      // Invalidate cache\r\n      this.invalidateCache();\r\n\r\n      return { success: true };\r\n    } catch (error) {\r\n      console.error(`Failed to update quizz ${id}:`, error);\r\n      return { success: false, error: \"Failed to write file\" };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Delete a quiz (async)\r\n   */\r\n  static async delete(\r\n    id: string,\r\n  ): Promise<{ success: boolean; error?: string }> {\r\n    const filePath = getPath(`quizz/${id}.json`);\r\n\r\n    // Check if quiz exists\r\n    try {\r\n      await fs.access(filePath);\r\n    } catch {\r\n      return { success: false, error: \"Quiz not found\" };\r\n    }\r\n\r\n    try {\r\n      await fs.unlink(filePath);\r\n\r\n      // Invalidate cache\r\n      this.invalidateCache();\r\n\r\n      return { success: true };\r\n    } catch (error) {\r\n      console.error(`Failed to delete quizz ${id}:`, error);\r\n      return { success: false, error: \"Failed to delete file\" };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Invalidate cache\r\n   */\r\n  static invalidateCache(): void {\r\n    this.cache.clear();\r\n    this.cacheTimestamp = 0;\r\n  }\r\n\r\n  /**\r\n   * Get cache stats (for monitoring)\r\n   */\r\n  static getCacheStats(): {\r\n    size: number;\r\n    age: number;\r\n    ttl: number;\r\n  } {\r\n    return {\r\n      size: this.cache.size,\r\n      age: Date.now() - this.cacheTimestamp,\r\n      ttl: this.CACHE_TTL,\r\n    };\r\n  }\r\n}\r\n\r\nexport default QuizzService;\r\n", "import {\r\n  createQuizzValidator,\r\n  deleteQuizzValidator,\r\n  quizzIdValidator,\r\n  updateQuizzValidator,\r\n} from \"@/common/validators/quizz\";\r\nimport QuizzService from \"@cahoot/socket/services/quizz\";\r\nimport { Request, Response, Router } from \"express\";\r\n\r\nconst router = Router();\r\n\r\n// Get all quizzes\r\nrouter.get(\"/\", async (req: Request, res: Response) => {\r\n  try {\r\n    const quizzes = await QuizzService.getAll();\r\n    res.json(quizzes);\r\n  } catch (error) {\r\n    console.error(\"Failed to get quizzes:\", error);\r\n    res.status(500).json({ error: \"Failed to fetch quizzes\" });\r\n  }\r\n});\r\n\r\n// Get a single quiz by ID\r\nrouter.get(\"/:id\", async (req: Request, res: Response) => {\r\n  const result = quizzIdValidator.safeParse(req.params.id);\r\n\r\n  if (result.error) {\r\n    return res.status(400).json({ error: result.error.issues[0].message });\r\n  }\r\n\r\n  const id = result.data;\r\n\r\n  try {\r\n    const quiz = await QuizzService.getById(id);\r\n\r\n    if (!quiz) {\r\n      return res.status(404).json({ error: \"Quiz not found\" });\r\n    }\r\n\r\n    res.json(quiz);\r\n  } catch (error) {\r\n    console.error(`Failed to get quiz ${id}:`, error);\r\n    res.status(500).json({ error: \"Failed to fetch quiz\" });\r\n  }\r\n});\r\n\r\n// Create a new quiz\r\nrouter.post(\"/\", async (req: Request, res: Response) => {\r\n  const result = createQuizzValidator.safeParse(req.body);\r\n\r\n  if (result.error) {\r\n    return res.status(400).json({ error: result.error.issues[0].message });\r\n  }\r\n\r\n  try {\r\n    const { id, data } = result.data;\r\n    const createResult = await QuizzService.create(id, data);\r\n\r\n    if (!createResult.success) {\r\n      return res\r\n        .status(400)\r\n        .json({ error: createResult.error || \"Failed to create quiz\" });\r\n    }\r\n\r\n    const newQuiz = await QuizzService.getById(id);\r\n\r\n    if (!newQuiz) {\r\n      return res.status(500).json({ error: \"Failed to retrieve created quiz\" });\r\n    }\r\n\r\n    res.status(201).json(newQuiz);\r\n  } catch (error) {\r\n    console.error(\"Failed to create quiz:\", error);\r\n    res.status(500).json({ error: \"Failed to create quiz\" });\r\n  }\r\n});\r\n\r\n// Update an existing quiz\r\nrouter.put(\"/:id\", async (req: Request, res: Response) => {\r\n  const idResult = quizzIdValidator.safeParse(req.params.id);\r\n\r\n  if (idResult.error) {\r\n    return res.status(400).json({ error: idResult.error.issues[0].message });\r\n  }\r\n\r\n  const result = updateQuizzValidator.safeParse({\r\n    id: req.params.id,\r\n    data: req.body,\r\n  });\r\n\r\n  if (result.error) {\r\n    return res.status(400).json({ error: result.error.issues[0].message });\r\n  }\r\n\r\n  try {\r\n    const { id, data } = result.data;\r\n    const updateResult = await QuizzService.update(id, data);\r\n\r\n    if (!updateResult.success) {\r\n      return res\r\n        .status(400)\r\n        .json({ error: updateResult.error || \"Failed to update quiz\" });\r\n    }\r\n\r\n    const updatedQuiz = await QuizzService.getById(id);\r\n\r\n    if (!updatedQuiz) {\r\n      return res.status(404).json({ error: \"Quiz not found\" });\r\n    }\r\n\r\n    res.json(updatedQuiz);\r\n  } catch (error) {\r\n    console.error(\"Failed to update quiz:\", error);\r\n    res.status(500).json({ error: \"Failed to update quiz\" });\r\n  }\r\n});\r\n\r\n// Delete a quiz\r\nrouter.delete(\"/:id\", async (req: Request, res: Response) => {\r\n  const result = deleteQuizzValidator.safeParse({ id: req.params.id });\r\n\r\n  if (result.error) {\r\n    return res.status(400).json({ error: result.error.issues[0].message });\r\n  }\r\n\r\n  try {\r\n    const { id } = result.data;\r\n    const deleteResult = await QuizzService.delete(id);\r\n\r\n    if (!deleteResult.success) {\r\n      return res\r\n        .status(400)\r\n        .json({ error: deleteResult.error || \"Failed to delete quiz\" });\r\n    }\r\n\r\n    res.json({ message: \"Quiz deleted successfully\", id });\r\n  } catch (error) {\r\n    console.error(\"Failed to delete quiz:\", error);\r\n    res.status(500).json({ error: \"Failed to delete quiz\" });\r\n  }\r\n});\r\n\r\nexport default router;\r\n", "import { createEnv } from \"@t3-oss/env-core\";\r\nimport { z } from \"zod/v4\";\r\n\r\nconst env = createEnv({\r\n  server: {\r\n    NODE_ENV: z\r\n      .enum([\"development\", \"production\"])\r\n      .optional()\r\n      .default(\"development\"),\r\n    WEB_ORIGIN: z.string().optional().default(\"http://localhost:3000\"),\r\n    PORT: z.string().optional().default(\"3001\"),\r\n  },\r\n\r\n  runtimeEnv: {\r\n    NODE_ENV: process.env.NODE_ENV,\r\n    WEB_ORIGIN: process.env.WEB_ORIGIN,\r\n    PORT: process.env.PORT,\r\n  },\r\n});\r\n\r\nexport default env;\r\n", "import { QuizzWithId } from \"@/common/types/game\";\r\nimport fs from \"fs\";\r\nimport { resolve } from \"path\";\r\n\r\nconst inContainerPath = process.env.CONFIG_PATH;\r\n\r\nconst getPath = (path: string = \"\") =>\r\n  inContainerPath\r\n    ? resolve(inContainerPath, path)\r\n    : resolve(process.cwd(), \"config\", path);\r\n\r\nclass Config {\r\n  static init() {\r\n    const isConfigFolderExists = fs.existsSync(getPath());\r\n\r\n    if (!isConfigFolderExists) {\r\n      fs.mkdirSync(getPath());\r\n    }\r\n\r\n    const isGameConfigExists = fs.existsSync(getPath(\"game.json\"));\r\n\r\n    if (!isGameConfigExists) {\r\n      fs.writeFileSync(\r\n        getPath(\"game.json\"),\r\n        JSON.stringify(\r\n          {\r\n            managerPassword: \"PASSWORD\",\r\n            music: true,\r\n          },\r\n          null,\r\n          2,\r\n        ),\r\n      );\r\n    }\r\n\r\n    const isQuizzExists = fs.existsSync(getPath(\"quizz\"));\r\n\r\n    if (!isQuizzExists) {\r\n      fs.mkdirSync(getPath(\"quizz\"));\r\n\r\n      fs.writeFileSync(\r\n        getPath(\"quizz/example.json\"),\r\n        JSON.stringify(\r\n          {\r\n            subject: \"Example Quizz\",\r\n            questions: [\r\n              {\r\n                question: \"What is good answer ?\",\r\n                answers: [\"No\", \"Good answer\", \"No\", \"No\"],\r\n                solution: 1,\r\n                cooldown: 5,\r\n                time: 15,\r\n              },\r\n              {\r\n                question: \"What is good answer with image ?\",\r\n                answers: [\"No\", \"No\", \"No\", \"Good answer\"],\r\n                image: \"https://placehold.co/600x400.png\",\r\n                solution: 3,\r\n                cooldown: 5,\r\n                time: 20,\r\n              },\r\n              {\r\n                question: \"What is good answer with two answers ?\",\r\n                answers: [\"Good answer\", \"No\"],\r\n                image: \"https://placehold.co/600x400.png\",\r\n                solution: 0,\r\n                cooldown: 5,\r\n                time: 20,\r\n              },\r\n            ],\r\n          },\r\n          null,\r\n          2,\r\n        ),\r\n      );\r\n    }\r\n  }\r\n\r\n  static game() {\r\n    const isExists = fs.existsSync(getPath(\"game.json\"));\r\n\r\n    if (!isExists) {\r\n      throw new Error(\"Game config not found\");\r\n    }\r\n\r\n    try {\r\n      const config = fs.readFileSync(getPath(\"game.json\"), \"utf-8\");\r\n\r\n      return JSON.parse(config);\r\n    } catch (error) {\r\n      console.error(\"Failed to read game config:\", error);\r\n    }\r\n\r\n    return {};\r\n  }\r\n\r\n  static quizz() {\r\n    const isExists = fs.existsSync(getPath(\"quizz\"));\r\n\r\n    if (!isExists) {\r\n      return [];\r\n    }\r\n\r\n    try {\r\n      const files = fs\r\n        .readdirSync(getPath(\"quizz\"))\r\n        .filter((file) => file.endsWith(\".json\"));\r\n\r\n      const quizz: QuizzWithId[] = files.map((file) => {\r\n        const data = fs.readFileSync(getPath(`quizz/${file}`), \"utf-8\");\r\n        const config = JSON.parse(data);\r\n\r\n        const id = file.replace(\".json\", \"\");\r\n\r\n        return {\r\n          id,\r\n          ...config,\r\n        };\r\n      });\r\n\r\n      return quizz || [];\r\n    } catch (error) {\r\n      console.error(\"Failed to read quizz config:\", error);\r\n\r\n      return [];\r\n    }\r\n  }\r\n}\r\n\r\nexport default Config;\r\n", "import { Player } from \".\";\r\n\r\nexport const STATUS = {\r\n  SHOW_ROOM: \"SHOW_ROOM\",\r\n  SHOW_START: \"SHOW_START\",\r\n  SHOW_PREPARED: \"SHOW_PREPARED\",\r\n  SHOW_QUESTION: \"SHOW_QUESTION\",\r\n  SELECT_ANSWER: \"SELECT_ANSWER\",\r\n  SHOW_RESULT: \"SHOW_RESULT\",\r\n  SHOW_RESPONSES: \"SHOW_RESPONSES\",\r\n  SHOW_LEADERBOARD: \"SHOW_LEADERBOARD\",\r\n  FINISHED: \"FINISHED\",\r\n  WAIT: \"WAIT\",\r\n} as const;\r\n\r\nexport type Status = (typeof STATUS)[keyof typeof STATUS];\r\n\r\nexport type CommonStatusDataMap = {\r\n  SHOW_START: { time: number; subject: string };\r\n  SHOW_PREPARED: { totalAnswers: number; questionNumber: number };\r\n  SHOW_QUESTION: { question: string; image?: string; cooldown: number };\r\n  SELECT_ANSWER: {\r\n    question: string;\r\n    answers: string[];\r\n    image?: string;\r\n    time: number;\r\n    totalPlayer: number;\r\n  };\r\n  SHOW_RESULT: {\r\n    correct: boolean;\r\n    message: string;\r\n    points: number;\r\n    myPoints: number;\r\n    rank: number;\r\n    aheadOfMe: string | null;\r\n  };\r\n  WAIT: { text: string };\r\n  FINISHED: { subject: string; top: Player[] };\r\n};\r\n\r\ntype ManagerExtraStatus = {\r\n  SHOW_ROOM: { text: string; inviteCode?: string };\r\n  SHOW_RESPONSES: {\r\n    question: string;\r\n    responses: Record<number, number>;\r\n    correct: number;\r\n    answers: string[];\r\n    image?: string;\r\n  };\r\n  SHOW_LEADERBOARD: { oldLeaderboard: Player[]; leaderboard: Player[] };\r\n};\r\n\r\nexport type PlayerStatusDataMap = CommonStatusDataMap;\r\nexport type ManagerStatusDataMap = CommonStatusDataMap & ManagerExtraStatus;\r\nexport type StatusDataMap = PlayerStatusDataMap & ManagerStatusDataMap;\r\n", "import Game from \"@cahoot/socket/services/game\";\r\nimport dayjs from \"dayjs\";\r\n\r\ninterface EmptyGame {\r\n  since: number;\r\n  game: Game;\r\n}\r\n\r\nclass Registry {\r\n  private static instance: Registry | null = null;\r\n  private games: Game[] = [];\r\n  private emptyGames: EmptyGame[] = [];\r\n  private cleanupInterval: ReturnType<typeof setTimeout> | null = null;\r\n  private readonly EMPTY_GAME_TIMEOUT_MINUTES = 5;\r\n  private readonly CLEANUP_INTERVAL_MS = 60_000;\r\n\r\n  private constructor() {\r\n    this.startCleanupTask();\r\n  }\r\n\r\n  static getInstance(): Registry {\r\n    Registry.instance ||= new Registry();\r\n\r\n    return Registry.instance;\r\n  }\r\n\r\n  addGame(game: Game): void {\r\n    this.games.push(game);\r\n    console.log(`Game ${game.gameId} added. Total games: ${this.games.length}`);\r\n  }\r\n\r\n  getGameById(gameId: string): Game | undefined {\r\n    return this.games.find((g) => g.gameId === gameId);\r\n  }\r\n\r\n  getGameByInviteCode(inviteCode: string): Game | undefined {\r\n    return this.games.find((g) => g.inviteCode === inviteCode);\r\n  }\r\n\r\n  getPlayerGame(gameId: string, clientId: string): Game | undefined {\r\n    return this.games.find(\r\n      (g) =>\r\n        g.gameId === gameId && g.players.some((p) => p.clientId === clientId),\r\n    );\r\n  }\r\n\r\n  getManagerGame(gmageId: string, clientId: string): Game | undefined {\r\n    return this.games.find(\r\n      (g) => g.gameId === gmageId && g.manager.clientId === clientId,\r\n    );\r\n  }\r\n\r\n  getGameByManagerSocketId(socketId: string): Game | undefined {\r\n    return this.games.find((g) => g.manager.id === socketId);\r\n  }\r\n\r\n  getGameByPlayerSocketId(socketId: string): Game | undefined {\r\n    return this.games.find((g) => g.players.some((p) => p.id === socketId));\r\n  }\r\n\r\n  markGameAsEmpty(game: Game): void {\r\n    const alreadyEmpty = this.emptyGames.find(\r\n      (g) => g.game.gameId === game.gameId,\r\n    );\r\n\r\n    if (!alreadyEmpty) {\r\n      this.emptyGames.push({\r\n        since: dayjs().unix(),\r\n        game,\r\n      });\r\n      console.log(\r\n        `Game ${game.gameId} marked as empty. Total empty games: ${this.emptyGames.length}`,\r\n      );\r\n    }\r\n  }\r\n\r\n  reactivateGame(gameId: string): void {\r\n    const initialLength = this.emptyGames.length;\r\n    this.emptyGames = this.emptyGames.filter((g) => g.game.gameId !== gameId);\r\n\r\n    if (this.emptyGames.length < initialLength) {\r\n      console.log(\r\n        `Game ${gameId} reactivated. Remaining empty games: ${this.emptyGames.length}`,\r\n      );\r\n    }\r\n  }\r\n\r\n  removeGame(gameId: string): boolean {\r\n    const initialLength = this.games.length;\r\n    this.games = this.games.filter((g) => g.gameId !== gameId);\r\n    this.emptyGames = this.emptyGames.filter((g) => g.game.gameId !== gameId);\r\n\r\n    const removed = this.games.length < initialLength;\r\n\r\n    if (removed) {\r\n      console.log(`Game ${gameId} removed. Total games: ${this.games.length}`);\r\n    }\r\n\r\n    return removed;\r\n  }\r\n\r\n  getAllGames(): Game[] {\r\n    return [...this.games];\r\n  }\r\n\r\n  getGameCount(): number {\r\n    return this.games.length;\r\n  }\r\n\r\n  getEmptyGameCount(): number {\r\n    return this.emptyGames.length;\r\n  }\r\n\r\n  private cleanupEmptyGames(): void {\r\n    const now = dayjs();\r\n    const stillEmpty = this.emptyGames.filter(\r\n      (g) =>\r\n        now.diff(dayjs.unix(g.since), \"minute\") <\r\n        this.EMPTY_GAME_TIMEOUT_MINUTES,\r\n    );\r\n\r\n    if (stillEmpty.length === this.emptyGames.length) {\r\n      return;\r\n    }\r\n\r\n    const removed = this.emptyGames.filter((g) => !stillEmpty.includes(g));\r\n    const removedGameIds = removed.map((r) => r.game.gameId);\r\n\r\n    this.games = this.games.filter((g) => !removedGameIds.includes(g.gameId));\r\n    this.emptyGames = stillEmpty;\r\n\r\n    console.log(\r\n      `Removed ${removed.length} empty game(s). Remaining games: ${this.games.length}`,\r\n    );\r\n  }\r\n\r\n  private startCleanupTask(): void {\r\n    this.cleanupInterval = setInterval(() => {\r\n      this.cleanupEmptyGames();\r\n    }, this.CLEANUP_INTERVAL_MS);\r\n\r\n    console.log(\"Game cleanup task started\");\r\n  }\r\n\r\n  stopCleanupTask(): void {\r\n    if (this.cleanupInterval) {\r\n      clearInterval(this.cleanupInterval);\r\n      this.cleanupInterval = null;\r\n      console.log(\"Game cleanup task stopped\");\r\n    }\r\n  }\r\n\r\n  cleanup(): void {\r\n    this.stopCleanupTask();\r\n    this.games = [];\r\n    this.emptyGames = [];\r\n    console.log(\"Registry cleaned up\");\r\n  }\r\n}\r\n\r\nexport default Registry;\r\n", "import { Socket } from \"@/common/types/game/socket\";\r\nimport Game from \"@cahoot/socket/services/game\";\r\nimport Registry from \"@cahoot/socket/services/registry\";\r\n\r\nexport const withGame = (\r\n  gameId: string | undefined,\r\n  socket: Socket,\r\n  callback: (_game: Game) => void,\r\n): void => {\r\n  if (!gameId) {\r\n    socket.emit(\"game:errorMessage\", \"Game not found\");\r\n\r\n    return;\r\n  }\r\n\r\n  const registry = Registry.getInstance();\r\n  const game = registry.getGameById(gameId);\r\n\r\n  if (!game) {\r\n    socket.emit(\"game:errorMessage\", \"Game not found\");\r\n\r\n    return;\r\n  }\r\n\r\n  callback(game);\r\n};\r\n\r\nexport const createInviteCode = (length = 6) => {\r\n  let result = \"\";\r\n  const characters = \"0123456789\";\r\n  const charactersLength = characters.length;\r\n\r\n  for (let i = 0; i < length; i += 1) {\r\n    const randomIndex = Math.floor(Math.random() * charactersLength);\r\n    result += characters.charAt(randomIndex);\r\n  }\r\n\r\n  return result;\r\n};\r\n\r\nexport const timeToPoint = (startTime: number, secondes: number): number => {\r\n  let points = 1000;\r\n\r\n  const actualTime = Date.now();\r\n  const tempsPasseEnSecondes = (actualTime - startTime) / 1000;\r\n\r\n  points -= (1000 / secondes) * tempsPasseEnSecondes;\r\n  points = Math.max(0, points);\r\n\r\n  return points;\r\n};\r\n", "export const sleep = (sec: number) =>\r\n  new Promise((r) => void setTimeout(r, sec * 1000))\r\n\r\nexport default sleep\r\n", "import { Answer, Player, Quizz } from \"@/common/types/game\";\r\nimport { Server, Socket } from \"@/common/types/game/socket\";\r\nimport { Status, STATUS, StatusDataMap } from \"@/common/types/game/status\";\r\nimport Registry from \"@cahoot/socket/services/registry\";\r\nimport { createInviteCode, timeToPoint } from \"@cahoot/socket/utils/game\";\r\nimport sleep from \"@cahoot/socket/utils/sleep\";\r\nimport { v4 as uuid } from \"uuid\";\r\n\r\nconst registry = Registry.getInstance();\r\n\r\nclass Game {\r\n  io: Server;\r\n\r\n  gameId: string;\r\n  manager: {\r\n    id: string;\r\n    clientId: string;\r\n    connected: boolean;\r\n  };\r\n  inviteCode: string;\r\n  started: boolean;\r\n\r\n  lastBroadcastStatus: { name: Status; data: StatusDataMap[Status] } | null =\r\n    null;\r\n  managerStatus: { name: Status; data: StatusDataMap[Status] } | null = null;\r\n  playerStatus: Map<string, { name: Status; data: StatusDataMap[Status] }> =\r\n    new Map();\r\n\r\n  leaderboard: Player[];\r\n  tempOldLeaderboard: Player[] | null;\r\n\r\n  quizz: Quizz;\r\n  players: Player[];\r\n\r\n  round: {\r\n    currentQuestion: number;\r\n    playersAnswers: Answer[];\r\n    startTime: number;\r\n  };\r\n\r\n  cooldown: {\r\n    active: boolean;\r\n    ms: number;\r\n  };\r\n\r\n  constructor(io: Server, socket: Socket, quizz: Quizz) {\r\n    if (!io) {\r\n      throw new Error(\"Socket server not initialized\");\r\n    }\r\n\r\n    this.io = io;\r\n    this.gameId = uuid();\r\n    this.manager = {\r\n      id: \"\",\r\n      clientId: \"\",\r\n      connected: false,\r\n    };\r\n    this.inviteCode = \"\";\r\n    this.started = false;\r\n\r\n    this.lastBroadcastStatus = null;\r\n    this.managerStatus = null;\r\n    this.playerStatus = new Map();\r\n\r\n    this.leaderboard = [];\r\n    this.tempOldLeaderboard = null;\r\n\r\n    this.players = [];\r\n\r\n    this.round = {\r\n      playersAnswers: [],\r\n      currentQuestion: 0,\r\n      startTime: 0,\r\n    };\r\n\r\n    this.cooldown = {\r\n      active: false,\r\n      ms: 0,\r\n    };\r\n\r\n    const roomInvite = createInviteCode();\r\n    this.inviteCode = roomInvite;\r\n    this.manager = {\r\n      id: socket.id,\r\n      clientId: socket.handshake.auth.clientId,\r\n      connected: true,\r\n    };\r\n    this.quizz = quizz;\r\n\r\n    socket.join(this.gameId);\r\n    socket.emit(\"manager:gameCreated\", {\r\n      gameId: this.gameId,\r\n      inviteCode: roomInvite,\r\n    });\r\n\r\n    console.log(\r\n      `New game created: ${roomInvite} subject: ${this.quizz.subject}`,\r\n    );\r\n  }\r\n\r\n  broadcastStatus<T extends Status>(status: T, data: StatusDataMap[T]) {\r\n    const statusData = { name: status, data };\r\n    this.lastBroadcastStatus = statusData;\r\n    this.io.to(this.gameId).emit(\"game:status\", statusData);\r\n  }\r\n\r\n  sendStatus<T extends Status>(\r\n    target: string,\r\n    status: T,\r\n    data: StatusDataMap[T],\r\n  ) {\r\n    const statusData = { name: status, data };\r\n\r\n    if (this.manager.id === target) {\r\n      this.managerStatus = statusData;\r\n    } else {\r\n      this.playerStatus.set(target, statusData);\r\n    }\r\n\r\n    this.io.to(target).emit(\"game:status\", statusData);\r\n  }\r\n\r\n  join(socket: Socket, username: string) {\r\n    const isAlreadyConnected = this.players.find(\r\n      (p) => p.clientId === socket.handshake.auth.clientId,\r\n    );\r\n\r\n    if (isAlreadyConnected) {\r\n      socket.emit(\"game:errorMessage\", \"Player already connected\");\r\n\r\n      return;\r\n    }\r\n\r\n    socket.join(this.gameId);\r\n\r\n    const playerData = {\r\n      id: socket.id,\r\n      clientId: socket.handshake.auth.clientId,\r\n      connected: true,\r\n      username,\r\n      points: 0,\r\n    };\r\n\r\n    this.players.push(playerData);\r\n\r\n    this.io.to(this.manager.id).emit(\"manager:newPlayer\", playerData);\r\n    this.io.to(this.gameId).emit(\"game:totalPlayers\", this.players.length);\r\n\r\n    socket.emit(\"game:successJoin\", this.gameId);\r\n  }\r\n\r\n  kickPlayer(socket: Socket, playerId: string) {\r\n    if (this.manager.id !== socket.id) {\r\n      return;\r\n    }\r\n\r\n    const player = this.players.find((p) => p.id === playerId);\r\n\r\n    if (!player) {\r\n      return;\r\n    }\r\n\r\n    this.players = this.players.filter((p) => p.id !== playerId);\r\n    this.playerStatus.delete(playerId);\r\n\r\n    this.io.in(playerId).socketsLeave(this.gameId);\r\n    this.io\r\n      .to(player.id)\r\n      .emit(\"game:reset\", \"You have been kicked by the manager\");\r\n    this.io.to(this.manager.id).emit(\"manager:playerKicked\", player.id);\r\n\r\n    this.io.to(this.gameId).emit(\"game:totalPlayers\", this.players.length);\r\n  }\r\n\r\n  reconnect(socket: Socket) {\r\n    const { clientId } = socket.handshake.auth;\r\n    const isManager = this.manager.clientId === clientId;\r\n\r\n    if (isManager) {\r\n      this.reconnectManager(socket);\r\n    } else {\r\n      this.reconnectPlayer(socket);\r\n    }\r\n  }\r\n\r\n  private reconnectManager(socket: Socket) {\r\n    if (this.manager.connected) {\r\n      socket.emit(\"game:reset\", \"Manager already connected\");\r\n\r\n      return;\r\n    }\r\n\r\n    socket.join(this.gameId);\r\n    this.manager.id = socket.id;\r\n    this.manager.connected = true;\r\n\r\n    const status = this.managerStatus ||\r\n      this.lastBroadcastStatus || {\r\n        name: STATUS.WAIT,\r\n        data: { text: \"Waiting for players\" },\r\n      };\r\n\r\n    socket.emit(\"manager:successReconnect\", {\r\n      gameId: this.gameId,\r\n      currentQuestion: {\r\n        current: this.round.currentQuestion + 1,\r\n        total: this.quizz.questions.length,\r\n      },\r\n      status,\r\n      players: this.players,\r\n    });\r\n    socket.emit(\"game:totalPlayers\", this.players.length);\r\n\r\n    registry.reactivateGame(this.gameId);\r\n    console.log(`Manager reconnected to game ${this.inviteCode}`);\r\n  }\r\n\r\n  private reconnectPlayer(socket: Socket) {\r\n    const { clientId } = socket.handshake.auth;\r\n    const player = this.players.find((p) => p.clientId === clientId);\r\n\r\n    if (!player) {\r\n      return;\r\n    }\r\n\r\n    if (player.connected) {\r\n      socket.emit(\"game:reset\", \"Player already connected\");\r\n\r\n      return;\r\n    }\r\n\r\n    socket.join(this.gameId);\r\n\r\n    const oldSocketId = player.id;\r\n    player.id = socket.id;\r\n    player.connected = true;\r\n\r\n    const status = this.playerStatus.get(oldSocketId) ||\r\n      this.lastBroadcastStatus || {\r\n        name: STATUS.WAIT,\r\n        data: { text: \"Waiting for players\" },\r\n      };\r\n\r\n    if (this.playerStatus.has(oldSocketId)) {\r\n      const oldStatus = this.playerStatus.get(oldSocketId)!;\r\n      this.playerStatus.delete(oldSocketId);\r\n      this.playerStatus.set(socket.id, oldStatus);\r\n    }\r\n\r\n    socket.emit(\"player:successReconnect\", {\r\n      gameId: this.gameId,\r\n      currentQuestion: {\r\n        current: this.round.currentQuestion + 1,\r\n        total: this.quizz.questions.length,\r\n      },\r\n      status,\r\n      player: {\r\n        username: player.username,\r\n        points: player.points,\r\n      },\r\n    });\r\n    socket.emit(\"game:totalPlayers\", this.players.length);\r\n    console.log(\r\n      `Player ${player.username} reconnected to game ${this.inviteCode}`,\r\n    );\r\n  }\r\n\r\n  startCooldown(seconds: number): Promise<void> {\r\n    if (this.cooldown.active) {\r\n      return Promise.resolve();\r\n    }\r\n\r\n    this.cooldown.active = true;\r\n    let count = seconds - 1;\r\n\r\n    return new Promise<void>((resolve) => {\r\n      const cooldownTimeout = setInterval(() => {\r\n        if (!this.cooldown.active || count <= 0) {\r\n          this.cooldown.active = false;\r\n          clearInterval(cooldownTimeout);\r\n          resolve();\r\n\r\n          return;\r\n        }\r\n\r\n        this.io.to(this.gameId).emit(\"game:cooldown\", count);\r\n        count -= 1;\r\n      }, 1000);\r\n    });\r\n  }\r\n\r\n  abortCooldown() {\r\n    this.cooldown.active &&= false;\r\n  }\r\n\r\n  async start(socket: Socket) {\r\n    if (this.manager.id !== socket.id) {\r\n      return;\r\n    }\r\n\r\n    if (this.started) {\r\n      return;\r\n    }\r\n\r\n    this.started = true;\r\n\r\n    this.broadcastStatus(STATUS.SHOW_START, {\r\n      time: 3,\r\n      subject: this.quizz.subject,\r\n    });\r\n\r\n    await sleep(3);\r\n\r\n    this.io.to(this.gameId).emit(\"game:startCooldown\");\r\n    await this.startCooldown(3);\r\n\r\n    this.newRound();\r\n  }\r\n\r\n  async newRound() {\r\n    const question = this.quizz.questions[this.round.currentQuestion];\r\n\r\n    if (!this.started) {\r\n      return;\r\n    }\r\n\r\n    this.playerStatus.clear();\r\n\r\n    this.io.to(this.gameId).emit(\"game:updateQuestion\", {\r\n      current: this.round.currentQuestion + 1,\r\n      total: this.quizz.questions.length,\r\n    });\r\n\r\n    this.managerStatus = null;\r\n    this.broadcastStatus(STATUS.SHOW_PREPARED, {\r\n      totalAnswers: question.answers.length,\r\n      questionNumber: this.round.currentQuestion + 1,\r\n    });\r\n\r\n    await sleep(2);\r\n\r\n    if (!this.started) {\r\n      return;\r\n    }\r\n\r\n    this.broadcastStatus(STATUS.SHOW_QUESTION, {\r\n      question: question.question,\r\n      image: question.image,\r\n      cooldown: question.cooldown,\r\n    });\r\n\r\n    await sleep(question.cooldown);\r\n\r\n    if (!this.started) {\r\n      return;\r\n    }\r\n\r\n    this.round.startTime = Date.now();\r\n\r\n    this.broadcastStatus(STATUS.SELECT_ANSWER, {\r\n      question: question.question,\r\n      answers: question.answers,\r\n      image: question.image,\r\n      time: question.time,\r\n      totalPlayer: this.players.length,\r\n    });\r\n\r\n    await this.startCooldown(question.time);\r\n\r\n    if (!this.started) {\r\n      return;\r\n    }\r\n\r\n    this.showResults(question);\r\n  }\r\n\r\n  showResults(question: any) {\r\n    const oldLeaderboard =\r\n      this.leaderboard.length === 0\r\n        ? this.players.map((p) => ({ ...p }))\r\n        : this.leaderboard.map((p) => ({ ...p }));\r\n\r\n    const totalType = this.round.playersAnswers.reduce(\r\n      (acc: Record<number, number>, { answerId }) => {\r\n        acc[answerId] = (acc[answerId] || 0) + 1;\r\n\r\n        return acc;\r\n      },\r\n      {},\r\n    );\r\n\r\n    const sortedPlayers = this.players\r\n      .map((player) => {\r\n        const playerAnswer = this.round.playersAnswers.find(\r\n          (a) => a.playerId === player.id,\r\n        );\r\n\r\n        const isCorrect = playerAnswer\r\n          ? playerAnswer.answerId === question.solution\r\n          : false;\r\n\r\n        const points =\r\n          playerAnswer && isCorrect ? Math.round(playerAnswer.points) : 0;\r\n\r\n        player.points += points;\r\n\r\n        return { ...player, lastCorrect: isCorrect, lastPoints: points };\r\n      })\r\n      .sort((a, b) => b.points - a.points);\r\n\r\n    this.players = sortedPlayers;\r\n\r\n    sortedPlayers.forEach((player, index) => {\r\n      const rank = index + 1;\r\n      const aheadPlayer = sortedPlayers[index - 1];\r\n\r\n      this.sendStatus(player.id, STATUS.SHOW_RESULT, {\r\n        correct: player.lastCorrect,\r\n        message: player.lastCorrect ? \"Nice!\" : \"Too bad\",\r\n        points: player.lastPoints,\r\n        myPoints: player.points,\r\n        rank,\r\n        aheadOfMe: aheadPlayer ? aheadPlayer.username : null,\r\n      });\r\n    });\r\n\r\n    this.sendStatus(this.manager.id, STATUS.SHOW_RESPONSES, {\r\n      question: question.question,\r\n      responses: totalType,\r\n      correct: question.solution,\r\n      answers: question.answers,\r\n      image: question.image,\r\n    });\r\n\r\n    this.leaderboard = sortedPlayers;\r\n    this.tempOldLeaderboard = oldLeaderboard;\r\n\r\n    this.round.playersAnswers = [];\r\n  }\r\n  selectAnswer(socket: Socket, answerId: number) {\r\n    const player = this.players.find((player) => player.id === socket.id);\r\n    const question = this.quizz.questions[this.round.currentQuestion];\r\n\r\n    if (!player) {\r\n      return;\r\n    }\r\n\r\n    if (this.round.playersAnswers.find((p) => p.playerId === socket.id)) {\r\n      return;\r\n    }\r\n\r\n    this.round.playersAnswers.push({\r\n      playerId: player.id,\r\n      answerId,\r\n      points: timeToPoint(this.round.startTime, question.time),\r\n    });\r\n\r\n    this.sendStatus(socket.id, STATUS.WAIT, {\r\n      text: \"Waiting for the players to answer\",\r\n    });\r\n\r\n    socket\r\n      .to(this.gameId)\r\n      .emit(\"game:playerAnswer\", this.round.playersAnswers.length);\r\n\r\n    this.io.to(this.gameId).emit(\"game:totalPlayers\", this.players.length);\r\n\r\n    if (this.round.playersAnswers.length === this.players.length) {\r\n      this.abortCooldown();\r\n    }\r\n  }\r\n\r\n  nextRound(socket: Socket) {\r\n    if (!this.started) {\r\n      return;\r\n    }\r\n\r\n    if (socket.id !== this.manager.id) {\r\n      return;\r\n    }\r\n\r\n    if (!this.quizz.questions[this.round.currentQuestion + 1]) {\r\n      return;\r\n    }\r\n\r\n    this.round.currentQuestion += 1;\r\n    this.newRound();\r\n  }\r\n\r\n  abortRound(socket: Socket) {\r\n    if (!this.started) {\r\n      return;\r\n    }\r\n\r\n    if (socket.id !== this.manager.id) {\r\n      return;\r\n    }\r\n\r\n    this.abortCooldown();\r\n  }\r\n\r\n  showLeaderboard() {\r\n    const isLastRound =\r\n      this.round.currentQuestion + 1 === this.quizz.questions.length;\r\n\r\n    if (isLastRound) {\r\n      this.started = false;\r\n\r\n      this.broadcastStatus(STATUS.FINISHED, {\r\n        subject: this.quizz.subject,\r\n        top: this.leaderboard.slice(0, 3),\r\n      });\r\n\r\n      // Mark game as empty for cleanup after game finishes\r\n      registry.markGameAsEmpty(this);\r\n      console.log(`Game ${this.gameId} finished and marked for cleanup`);\r\n\r\n      return;\r\n    }\r\n\r\n    const oldLeaderboard = this.tempOldLeaderboard\r\n      ? this.tempOldLeaderboard\r\n      : this.leaderboard;\r\n\r\n    this.sendStatus(this.manager.id, STATUS.SHOW_LEADERBOARD, {\r\n      oldLeaderboard: oldLeaderboard.slice(0, 5),\r\n      leaderboard: this.leaderboard.slice(0, 5),\r\n    });\r\n\r\n    this.tempOldLeaderboard = null;\r\n  }\r\n}\r\n\r\nexport default Game;\r\n", "import { Server } from \"@/common/types/game/socket\";\r\nimport { inviteCodeValidator } from \"@/common/validators/auth\";\r\nimport {\r\n  createQuizzValidator,\r\n  deleteQuizzValidator,\r\n  quizzIdValidator,\r\n  updateQuizzValidator,\r\n} from \"@/common/validators/quizz\";\r\nimport quizzRouter from \"@/routes/quizz\";\r\nimport env from \"@cahoot/socket/env\";\r\nimport Config from \"@cahoot/socket/services/config\";\r\nimport Game from \"@cahoot/socket/services/game\";\r\nimport QuizzService from \"@cahoot/socket/services/quizz\";\r\nimport Registry from \"@cahoot/socket/services/registry\";\r\nimport { withGame } from \"@cahoot/socket/utils/game\";\r\nimport express from \"express\";\r\nimport { createServer } from \"http\";\r\nimport { Server as ServerIO } from \"socket.io\";\r\n\r\n// Initialize Express app\r\nconst app = express();\r\nconst httpServer = createServer(app);\r\n\r\n// Initialize Socket.IO with Express\r\nconst io: Server = new ServerIO(httpServer, {\r\n  cors: {\r\n    origin: env.WEB_ORIGIN || \"*\",\r\n    methods: [\"GET\", \"POST\"],\r\n    credentials: true,\r\n  },\r\n});\r\n\r\n// Express middleware\r\napp.use(express.json());\r\napp.use(express.urlencoded({ extended: true }));\r\n\r\n// CORS middleware for Express routes\r\napp.use((req, res, next) => {\r\n  const origin = req.headers.origin;\r\n  if (origin === env.WEB_ORIGIN || !env.WEB_ORIGIN) {\r\n    res.setHeader(\"Access-Control-Allow-Origin\", origin || \"*\");\r\n  }\r\n  res.setHeader(\r\n    \"Access-Control-Allow-Methods\",\r\n    \"GET, POST, PUT, DELETE, OPTIONS\",\r\n  );\r\n  res.setHeader(\"Access-Control-Allow-Headers\", \"Content-Type, Authorization\");\r\n  res.setHeader(\"Access-Control-Allow-Credentials\", \"true\");\r\n\r\n  if (req.method === \"OPTIONS\") {\r\n    return res.sendStatus(200);\r\n  }\r\n\r\n  next();\r\n});\r\n\r\n// Health check endpoint\r\napp.get(\"/\", (req, res) => {\r\n  res.json({\r\n    status: \"ok\",\r\n    service: \"Cahoot Socket Server\",\r\n    version: \"1.0.0\",\r\n    framework: \"Express + Socket.IO\",\r\n    uptime: process.uptime(),\r\n  });\r\n});\r\n\r\napp.get(\"/health\", (req, res) => {\r\n  const registry = Registry.getInstance();\r\n  res.json({\r\n    status: \"healthy\",\r\n    connections: io.engine.clientsCount,\r\n    games: registry.getAllGames().length,\r\n    uptime: process.uptime(),\r\n  });\r\n});\r\n\r\n// REST API Routes\r\napp.use(\"/api/quizz\", quizzRouter);\r\n\r\n// Error handling middleware\r\napp.use(\r\n  (\r\n    err: Error,\r\n    req: express.Request,\r\n    res: express.Response,\r\n    next: express.NextFunction,\r\n  ) => {\r\n    console.error(\"Express error:\", err);\r\n    res.status(500).json({\r\n      error: \"Internal server error\",\r\n      message:\r\n        process.env.NODE_ENV === \"production\"\r\n          ? \"Something went wrong\"\r\n          : err.message,\r\n    });\r\n  },\r\n);\r\n\r\n// Initialize config\r\nConfig.init();\r\n\r\nconst registry = Registry.getInstance();\r\nconst port = process.env.PORT ?? env.PORT ?? 3001;\r\n\r\nconsole.log(`Express + Socket.IO server running on port ${port}`);\r\nhttpServer.listen(Number(port));\r\n\r\nio.on(\"connection\", (socket) => {\r\n  console.log(\r\n    `A user connected: socketId: ${socket.id}, clientId: ${socket.handshake.auth.clientId}`,\r\n  );\r\n\r\n  socket.on(\"player:reconnect\", ({ gameId }) => {\r\n    const game = registry.getPlayerGame(gameId, socket.handshake.auth.clientId);\r\n\r\n    if (game) {\r\n      game.reconnect(socket);\r\n\r\n      return;\r\n    }\r\n\r\n    socket.emit(\"game:reset\", \"Game not found\");\r\n  });\r\n\r\n  socket.on(\"manager:reconnect\", ({ gameId }) => {\r\n    const game = registry.getManagerGame(\r\n      gameId,\r\n      socket.handshake.auth.clientId,\r\n    );\r\n\r\n    if (game) {\r\n      game.reconnect(socket);\r\n\r\n      return;\r\n    }\r\n\r\n    socket.emit(\"game:reset\", \"Game expired\");\r\n  });\r\n\r\n  socket.on(\"manager:auth\", (password) => {\r\n    try {\r\n      const config = Config.game();\r\n\r\n      if (password !== config.managerPassword) {\r\n        socket.emit(\"manager:errorMessage\", \"Invalid password\");\r\n\r\n        return;\r\n      }\r\n\r\n      socket.emit(\"manager:quizzList\", Config.quizz());\r\n    } catch (error) {\r\n      console.error(\"Failed to read game config:\", error);\r\n      socket.emit(\"manager:errorMessage\", \"Failed to read game config\");\r\n    }\r\n  });\r\n\r\n  socket.on(\"game:create\", (quizzId) => {\r\n    const quizzList = Config.quizz();\r\n    const quizz = quizzList.find((q) => q.id === quizzId);\r\n\r\n    if (!quizz) {\r\n      socket.emit(\"game:errorMessage\", \"Quizz not found\");\r\n\r\n      return;\r\n    }\r\n\r\n    const game = new Game(io, socket, quizz);\r\n    registry.addGame(game);\r\n  });\r\n\r\n  socket.on(\"player:join\", (inviteCode) => {\r\n    const result = inviteCodeValidator.safeParse(inviteCode);\r\n\r\n    if (result.error) {\r\n      socket.emit(\"game:errorMessage\", result.error.issues[0].message);\r\n\r\n      return;\r\n    }\r\n\r\n    const game = registry.getGameByInviteCode(inviteCode);\r\n\r\n    if (!game) {\r\n      socket.emit(\"game:errorMessage\", \"Game not found\");\r\n\r\n      return;\r\n    }\r\n\r\n    socket.emit(\"game:successRoom\", game.gameId);\r\n  });\r\n\r\n  socket.on(\"player:login\", ({ gameId, data }) =>\r\n    withGame(gameId, socket, (game) => game.join(socket, data.username)),\r\n  );\r\n\r\n  socket.on(\"manager:kickPlayer\", ({ gameId, playerId }) =>\r\n    withGame(gameId, socket, (game) => game.kickPlayer(socket, playerId)),\r\n  );\r\n\r\n  socket.on(\"manager:startGame\", ({ gameId }) =>\r\n    withGame(gameId, socket, (game) => game.start(socket)),\r\n  );\r\n\r\n  socket.on(\"player:selectedAnswer\", ({ gameId, data }) =>\r\n    withGame(gameId, socket, (game) =>\r\n      game.selectAnswer(socket, data.answerKey),\r\n    ),\r\n  );\r\n\r\n  socket.on(\"manager:abortQuiz\", ({ gameId }) =>\r\n    withGame(gameId, socket, (game) => game.abortRound(socket)),\r\n  );\r\n\r\n  socket.on(\"manager:nextQuestion\", ({ gameId }) =>\r\n    withGame(gameId, socket, (game) => game.nextRound(socket)),\r\n  );\r\n\r\n  socket.on(\"manager:showLeaderboard\", ({ gameId }) =>\r\n    withGame(gameId, socket, (game) => game.showLeaderboard()),\r\n  );\r\n\r\n  // ==================== QUIZ CRUD OPERATIONS ====================\r\n\r\n  // Get all quizzes\r\n  socket.on(\"quizz:getAll\", async () => {\r\n    try {\r\n      const quizzes = await QuizzService.getAll();\r\n      socket.emit(\"quizz:list\", quizzes);\r\n    } catch (error) {\r\n      console.error(\"Failed to get quizzes:\", error);\r\n      socket.emit(\"quizz:error\", \"Failed to fetch quizzes\");\r\n    }\r\n  });\r\n\r\n  // Get a single quiz by ID\r\n  socket.on(\"quizz:getById\", async (id) => {\r\n    const result = quizzIdValidator.safeParse(id);\r\n\r\n    if (result.error) {\r\n      socket.emit(\"quizz:error\", result.error.issues[0].message);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const quiz = await QuizzService.getById(id);\r\n\r\n      if (!quiz) {\r\n        socket.emit(\"quizz:error\", \"Quiz not found\");\r\n        return;\r\n      }\r\n\r\n      socket.emit(\"quizz:single\", quiz);\r\n    } catch (error) {\r\n      console.error(`Failed to get quiz ${id}:`, error);\r\n      socket.emit(\"quizz:error\", \"Failed to fetch quiz\");\r\n    }\r\n  });\r\n\r\n  // Create a new quiz\r\n  socket.on(\"quizz:create\", async (payload) => {\r\n    const result = createQuizzValidator.safeParse(payload);\r\n\r\n    if (result.error) {\r\n      socket.emit(\"quizz:error\", result.error.issues[0].message);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const { id, data } = result.data;\r\n      const createResult = await QuizzService.create(id, data);\r\n\r\n      if (!createResult.success) {\r\n        socket.emit(\r\n          \"quizz:error\",\r\n          createResult.error || \"Failed to create quiz\",\r\n        );\r\n        return;\r\n      }\r\n\r\n      const newQuiz = await QuizzService.getById(id);\r\n      if (!newQuiz) {\r\n        socket.emit(\"quizz:error\", \"Failed to retrieve created quiz\");\r\n        return;\r\n      }\r\n      socket.emit(\"quizz:created\", newQuiz);\r\n\r\n      // Broadcast to all connected clients\r\n      io.emit(\"quizz:updated\");\r\n    } catch (error) {\r\n      console.error(\"Failed to create quiz:\", error);\r\n      socket.emit(\"quizz:error\", \"Failed to create quiz\");\r\n    }\r\n  });\r\n\r\n  // Update an existing quiz\r\n  socket.on(\"quizz:update\", async (payload) => {\r\n    const result = updateQuizzValidator.safeParse(payload);\r\n\r\n    if (result.error) {\r\n      socket.emit(\"quizz:error\", result.error.issues[0].message);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const { id, data } = result.data;\r\n      const updateResult = await QuizzService.update(id, data);\r\n\r\n      if (!updateResult.success) {\r\n        socket.emit(\r\n          \"quizz:error\",\r\n          updateResult.error || \"Failed to update quiz\",\r\n        );\r\n        return;\r\n      }\r\n\r\n      const updatedQuiz = await QuizzService.getById(id);\r\n      if (updatedQuiz) {\r\n        socket.emit(\"quizz:updated\", updatedQuiz);\r\n      }\r\n\r\n      // Broadcast to all connected clients\r\n      io.emit(\"quizz:updated\");\r\n    } catch (error) {\r\n      console.error(\"Failed to update quiz:\", error);\r\n      socket.emit(\"quizz:error\", \"Failed to update quiz\");\r\n    }\r\n  });\r\n\r\n  // Delete a quiz\r\n  socket.on(\"quizz:delete\", async (payload) => {\r\n    const result = deleteQuizzValidator.safeParse(payload);\r\n\r\n    if (result.error) {\r\n      socket.emit(\"quizz:error\", result.error.issues[0].message);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const { id } = result.data;\r\n      const deleteResult = await QuizzService.delete(id);\r\n\r\n      if (!deleteResult.success) {\r\n        socket.emit(\r\n          \"quizz:error\",\r\n          deleteResult.error || \"Failed to delete quiz\",\r\n        );\r\n        return;\r\n      }\r\n\r\n      socket.emit(\"quizz:deleted\", { id });\r\n\r\n      // Broadcast to all connected clients\r\n      io.emit(\"quizz:updated\");\r\n    } catch (error) {\r\n      console.error(\"Failed to delete quiz:\", error);\r\n      socket.emit(\"quizz:error\", \"Failed to delete quiz\");\r\n    }\r\n  });\r\n\r\n  // ==================== END QUIZ CRUD OPERATIONS ====================\r\n\r\n  socket.on(\"disconnect\", () => {\r\n    console.log(`A user disconnected : ${socket.id}`);\r\n\r\n    const managerGame = registry.getGameByManagerSocketId(socket.id);\r\n\r\n    if (managerGame) {\r\n      managerGame.manager.connected = false;\r\n      registry.markGameAsEmpty(managerGame);\r\n\r\n      if (!managerGame.started) {\r\n        console.log(\"Reset game (manager disconnected)\");\r\n        managerGame.abortCooldown();\r\n        io.to(managerGame.gameId).emit(\"game:reset\", \"Manager disconnected\");\r\n        registry.removeGame(managerGame.gameId);\r\n\r\n        return;\r\n      }\r\n    }\r\n\r\n    const game = registry.getGameByPlayerSocketId(socket.id);\r\n\r\n    if (!game) {\r\n      return;\r\n    }\r\n\r\n    const player = game.players.find((p) => p.id === socket.id);\r\n\r\n    if (!player) {\r\n      return;\r\n    }\r\n\r\n    if (!game.started) {\r\n      game.players = game.players.filter((p) => p.id !== socket.id);\r\n\r\n      io.to(game.manager.id).emit(\"manager:removePlayer\", player.id);\r\n      io.to(game.gameId).emit(\"game:totalPlayers\", game.players.length);\r\n\r\n      console.log(`Removed player ${player.username} from game ${game.gameId}`);\r\n\r\n      return;\r\n    }\r\n\r\n    player.connected = false;\r\n    io.to(game.gameId).emit(\"game:totalPlayers\", game.players.length);\r\n  });\r\n});\r\n\r\nprocess.on(\"SIGINT\", () => {\r\n  Registry.getInstance().cleanup();\r\n  process.exit(0);\r\n});\r\n\r\nprocess.on(\"SIGTERM\", () => {\r\n  Registry.getInstance().cleanup();\r\n  process.exit(0);\r\n});\r\n"],
  "mappings": "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",
  "names": ["z", "usernameValidator", "inviteCodeValidator", "z", "quizzQuestionValidator", "quizzValidator", "quizzIdValidator", "createQuizzValidator", "updateQuizzValidator", "deleteQuizzValidator", "fsSync", "fs", "resolve", "inContainerPath", "getPath", "path", "QuizzService", "now", "quizzPath", "jsonFiles", "file", "quizzes", "data", "config", "quiz", "error", "id", "cached", "filePath", "quizzDir", "quizz_default", "Router", "router", "req", "res", "quizzes", "quizz_default", "error", "result", "quizzIdValidator", "id", "quiz", "createQuizzValidator", "data", "createResult", "newQuiz", "idResult", "updateQuizzValidator", "updateResult", "updatedQuiz", "deleteQuizzValidator", "deleteResult", "createEnv", "z", "env", "env_default", "fs", "resolve", "inContainerPath", "getPath", "path", "Config", "config", "error", "file", "data", "config_default", "STATUS", "dayjs", "Registry", "_Registry", "game", "gameId", "g", "inviteCode", "clientId", "p", "gmageId", "socketId", "initialLength", "removed", "now", "stillEmpty", "removedGameIds", "r", "registry_default", "withGame", "gameId", "socket", "callback", "game", "registry_default", "createInviteCode", "length", "result", "characters", "charactersLength", "i", "randomIndex", "timeToPoint", "startTime", "secondes", "points", "tempsPasseEnSecondes", "sleep", "sec", "r", "sleep_default", "uuid", "registry", "registry_default", "Game", "io", "socket", "quizz", "roomInvite", "createInviteCode", "status", "data", "statusData", "target", "username", "p", "playerData", "playerId", "player", "clientId", "STATUS", "oldSocketId", "oldStatus", "seconds", "count", "resolve", "cooldownTimeout", "sleep_default", "question", "oldLeaderboard", "totalType", "acc", "answerId", "sortedPlayers", "playerAnswer", "a", "isCorrect", "points", "b", "index", "rank", "aheadPlayer", "timeToPoint", "game_default", "express", "createServer", "ServerIO", "app", "httpServer", "io", "env_default", "req", "res", "next", "origin", "registry", "registry_default", "quizz_default", "err", "config_default", "port", "socket", "gameId", "game", "password", "config", "error", "quizzId", "quizz", "q", "game_default", "inviteCode", "result", "inviteCodeValidator", "data", "withGame", "playerId", "quizzes", "id", "quizzIdValidator", "quiz", "payload", "createQuizzValidator", "createResult", "newQuiz", "updateQuizzValidator", "updateResult", "updatedQuiz", "deleteQuizzValidator", "deleteResult", "managerGame", "player", "p"]
}
